
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.3">
    
    
      
        <title>Upgrade Gluster Version from 3.0 to 3.4 - Ops Runbooks for Fields</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.edf004c2.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#upgrade-gluster-version-from-30-to-34" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Ops Runbooks for Fields" class="md-header__button md-logo" aria-label="Ops Runbooks for Fields" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ops Runbooks for Fields
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Upgrade Gluster Version from 3.0 to 3.4
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/acquia/ops-runbook-fields.git/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Ops Runbooks for Fields" class="md-nav__button md-logo" aria-label="Ops Runbooks for Fields" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Ops Runbooks for Fields
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/acquia/ops-runbook-fields.git/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome to Ops Runbooks for Fields
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../toc/" class="md-nav__link">
        Table of Contents
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Escalation procedures
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Escalation procedures" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Escalation procedures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../escalation_procedures/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Incident response
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Incident response" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Incident response
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/" class="md-nav__link">
        Alerts by Check Name
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/Node.js-server-memory-nearing-threashold/" class="md-nav__link">
        Node.js server memory nearing threashold
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/Node.js_degradeded_stack/" class="md-nav__link">
        Node.js Degraded stack alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/ah-config-iptables_locked/" class="md-nav__link">
        ah-config-iptables locked
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/ah-critical/" class="md-nav__link">
        Master AH_CRITICAL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/ah-resource-mon/" class="md-nav__link">
        ah-resource-mon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/alerts_pagerduty_outage/" class="md-nav__link">
        How to Survive During a Pagerduty Outage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/backup_check/" class="md-nav__link">
        Backup Check
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/blocked_fcw_run/" class="md-nav__link">
        Blocked Fields Config Web Run alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/check_auditd/" class="md-nav__link">
        Check Auditd Agent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/check_clamav/" class="md-nav__link">
        As a first step
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/check_filesystem_fencing/" class="md-nav__link">
        Check Filesystem Fencing alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/check_gluster_transport_endpoint_error/" class="md-nav__link">
        Check Gluster Transport endpoint error
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/check_perfmon_data_is_recent/" class="md-nav__link">
        Check perfmon data is recent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/check_possible_hung_tasks/" class="md-nav__link">
        Check Possible Hung Tasks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/check_ssl_certificate/" class="md-nav__link">
        Check SSL Certificate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/critical_service_port_revoked/" class="md-nav__link">
        Critical Service Port Revoked
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/db_binlogs/" class="md-nav__link">
        MySQL binary log troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/dead_backup_tasks/" class="md-nav__link">
        Dead Backup Tasks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/debugging_php/" class="md-nav__link">
        Debugging PHP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/disk_partitions/" class="md-nav__link">
        Disk Partitions Alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/disk_writable/" class="md-nav__link">
        Disk Writable Alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/elb_issues/" class="md-nav__link">
        ELB Issues
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/fix-missing-glusterd_vol-file/" class="md-nav__link">
        Fix missing glusterd.vol file
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/gluster-not-split-brain/" class="md-nav__link">
        Not Split-brain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/gluster-troubleshooting/" class="md-nav__link">
        Gluster Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/impaired_server_relaunch/" class="md-nav__link">
        Relaunching impaired servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/index_ping_not_initiated/" class="md-nav__link">
        Sum Invocations LessThanThreshold 2.0 for FunctionName InitiateIndexCheck
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/instance_management_acp/" class="md-nav__link">
        ACP Instance Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/maintenance_past_due/" class="md-nav__link">
        Maintenance Past Due
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/malicious_high_traffic_hosts/" class="md-nav__link">
        Blocking Crawlers and Malicious High-Traffic Hosts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/mon_server_host_count/" class="md-nav__link">
        Mon Server Host Count
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/monitoring_audit/" class="md-nav__link">
        Monitoring Audit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/monthly_eip_audit/" class="md-nav__link">
        Handling monthly EIP audit tickets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/multiregion_rsync_verification/" class="md-nav__link">
        MultiRegion Rsync Verification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/mysql_available/" class="md-nav__link">
        MySQL Available
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/mysql_debian_sys_maint/" class="md-nav__link">
        MySQL Debian Sys Maint alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/mysql_failover/" class="md-nav__link">
        MySQL Failover
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/mysql_replication_lag/" class="md-nav__link">
        MySQL replication lag
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/nagios_configuration/" class="md-nav__link">
        Nagios Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/nginx_config_test/" class="md-nav__link">
        NGINX Configtest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/nxephem_nginx/" class="md-nav__link">
        Nxephem Nginx Configtest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/out_of_memory_errors/" class="md-nav__link">
        Out Of Memory (OOM) errors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/perf_url_mon/" class="md-nav__link">
        Perf URL Mon Alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/pupgov/" class="md-nav__link">
        Pupgov Alerts Runbook
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/puppet_agent_disabled/" class="md-nav__link">
        Puppet Agent Disabled alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/puppet_agent_run_status/" class="md-nav__link">
        Puppet Agent Run Status
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/search_index_mon/" class="md-nav__link">
        Search Core Index Alerts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/services_check/" class="md-nav__link">
        Services Check
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/site_capacity/" class="md-nav__link">
        Site Capacity alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/tomcat_memory_check/" class="md-nav__link">
        Tomcat Memory Check alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/tomcat_running/" class="md-nav__link">
        Tomcat Running alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/triage_unresponsive_servers/" class="md-nav__link">
        Triage unresponsive ACE, ACP, ACSF, Network, trex and [WMG/UMG]Gardens servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/tungsten_latency/" class="md-nav__link">
        Tungsten Latency
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/tungsten_online/" class="md-nav__link">
        Tungsten Online
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/tungsten_troubleshooting/" class="md-nav__link">
        Troubleshooting Tungsten
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/unmonitored_sites_check/" class="md-nav__link">
        Unmonitored Site Check alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/varnish_http/" class="md-nav__link">
        Check Varnish HTTP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/vpn_connection/" class="md-nav__link">
        VPN Connection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/vpn_mon/" class="md-nav__link">
        Name of Alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/web_audit/" class="md-nav__link">
        Web Audit
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_62" type="checkbox" id="__nav_4_62" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_62">
          Host alert
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Host alert" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_62">
          <span class="md-nav__icon md-icon"></span>
          Host alert
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/host_alert/fsdbmesh/" class="md-nav__link">
        fsdbmesh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../incident_response/host_alert/master/" class="md-nav__link">
        Master Down
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Kanban tickets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Kanban tickets" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Kanban tickets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Kanban Tickets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.81_release/" class="md-nav__link">
        1.81 Hosting Release
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../acquiamail/" class="md-nav__link">
        Acquiamail.acquia.com Dump Restore
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../acsf_deprovision/" class="md-nav__link">
        Site Factory Sitegroup Deprovisioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../acsf_proxy/" class="md-nav__link">
        Identify ACSF Follower and Proxy Environments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add_custom_proxy_conf/" class="md-nav__link">
        Add a custom Mod-Proxy file to a Site
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add_remove_site_mon/" class="md-nav__link">
        Add/Remove Sites to/from Monitoring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add_remove_webs_from_rotation/" class="md-nav__link">
        Add/Remove Webs From Rotation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add_user/" class="md-nav__link">
        Bastion Provisioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ahrabot/" class="md-nav__link">
        Modify the list of bastion users that can sudo ahrabot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arbitrary_php.ini_settings/" class="md-nav__link">
        Arbitrary php.ini settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bastion_access/" class="md-nav__link">
        Bastion Access User Changes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bastion_troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bulk_site_move/" class="md-nav__link">
        Bulk Site Move
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bulk_site_php_edits/" class="md-nav__link">
        Bulk Site PHP Edits
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../capacity-limit/" class="md-nav__link">
        Edge Cluster Capacity limit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../change_balancers_on_existing_environment/" class="md-nav__link">
        Change balancers on existing environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../change_db_password/" class="md-nav__link">
        Site Database Password Change
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../clamav/" class="md-nav__link">
        ClamAV Daemon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code_checkout_failures/" class="md-nav__link">
        Code Checkout Failures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configuring_hsd_for_sites/" class="md-nav__link">
        HSD (Higher Site Density)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../core_dumps/" class="md-nav__link">
        Enable Coredumps for Capturing PHP Segfaults
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../create_test_balancer/" class="md-nav__link">
        Create a test balancer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../custom_tungsten_settings/" class="md-nav__link">
        Custom Tungsten Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dedicated_hypervisor/" class="md-nav__link">
        Set tenancy for the servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dedicated_memcache/" class="md-nav__link">
        Dedicated Memcache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../delete_search_index/" class="md-nav__link">
        Deleting a Search Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deploy_certificate/" class="md-nav__link">
        Deploying an SSL / TLS certificate to a balancer cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deploy_test_vcl/" class="md-nav__link">
        Deploy custom VCL for customer testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deprovision_search_colony/" class="md-nav__link">
        Deprovision a Search Colony
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deprovision_search_farm/" class="md-nav__link">
        Deprovision a Search Farm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deprovisioning_ace/" class="md-nav__link">
        Deprovisioning ACE & ACP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deprovisioning_mail_server/" class="md-nav__link">
        Deprovisoning a mail server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../diagnostics/" class="md-nav__link">
        Diagnostics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../disable_tls_version/" class="md-nav__link">
        Disable TLS versions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../duplicate_certificates/" class="md-nav__link">
        Duplicate Certificates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../edge_cluster/" class="md-nav__link">
        Edge Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../elb_creation/" class="md-nav__link">
        ELB Creation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../email_blacklist/" class="md-nav__link">
        Acquia Email Server Blacklist Removal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../enabling_mod_proxy/" class="md-nav__link">
        Enabling Mod-Proxy on a Site
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../enabling_xdebug/" class="md-nav__link">
        Enabling xdebug for a Site
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../extended_validation_certificates/" class="md-nav__link">
        Extended Validation Certificates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fix_livedev/" class="md-nav__link">
        Fixing/Enabling livedev
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../generating_csrs/" class="md-nav__link">
        Generating a Certificate Signing Request (CSR)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gluster-downgrade/" class="md-nav__link">
        Downgrade Gluster Version from 3.4 to 3.0
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Upgrade Gluster Version from 3.0 to 3.4
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Upgrade Gluster Version from 3.0 to 3.4
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#this-process-should-be-used-only-on-gluster-30-servers" class="md-nav__link">
    THIS PROCESS SHOULD BE USED ONLY ON GLUSTER 3.0 SERVERS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initial-variables" class="md-nav__link">
    Initial Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#info-gathering" class="md-nav__link">
    Info Gathering
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#provision-new-fs-servers-and-fix-volumes" class="md-nav__link">
    Provision new FS servers and fix volumes
  </a>
  
    <nav class="md-nav" aria-label="Provision new FS servers and fix volumes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#allocate-new-fs-servers" class="md-nav__link">
    Allocate new FS servers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-brick-volumes" class="md-nav__link">
    Add brick volumes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-fs-servers-for-gluster-34" class="md-nav__link">
    Configure FS servers for gluster 3.4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocate-fs-cluster" class="md-nav__link">
    Allocate FS cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fix-backup-vol-on-secondary-server-to-1gb" class="md-nav__link">
    Fix backup vol on secondary server to 1gb
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fix-ebs1-volumes-on-both-servers-to-1gb" class="md-nav__link">
    Fix ebs1 volumes on both servers to 1gb
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#launch-fs-servers" class="md-nav__link">
    Launch FS Servers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filesystem-data-transfer" class="md-nav__link">
    Filesystem Data Transfer
  </a>
  
    <nav class="md-nav" aria-label="Filesystem Data Transfer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-temporary-ssh-key" class="md-nav__link">
    Create Temporary SSH key
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsync-from-source-server-to-destination-server" class="md-nav__link">
    rsync from source server to destination server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-servers-cutover" class="md-nav__link">
    Web servers cutover
  </a>
  
    <nav class="md-nav" aria-label="Web servers cutover">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#take-webs-out-of-rotation" class="md-nav__link">
    Take webs out of rotation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#re-run-rysnc" class="md-nav__link">
    Re-run rysnc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-puppet-and-cron-on-webs" class="md-nav__link">
    Disable Puppet and cron on webs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stop-gluster-and-unmount-gluster" class="md-nav__link">
    Stop gluster and Unmount gluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-webs-to-new-fs-cluster" class="md-nav__link">
    Add webs to New FS cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relaunch-suspended-webs" class="md-nav__link">
    Relaunch suspended webs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remount-gluster-on-webs" class="md-nav__link">
    Remount gluster on webs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-gluster-for-site" class="md-nav__link">
    check gluster for site
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-webs-back-into-rotation" class="md-nav__link">
    Put webs back into rotation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart-php-run-fcw-on-webs" class="md-nav__link">
    Restart PHP, Run FCW on webs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification" class="md-nav__link">
    Verification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup" class="md-nav__link">
    Cleanup
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../loadtest_balancer/" class="md-nav__link">
        Load Test Balancer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../logforward/" class="md-nav__link">
        Log Forwarding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manage_end_to_end_encryption/" class="md-nav__link">
        Manage End To End Encryption
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../masterless_puppet/" class="md-nav__link">
        Masterless Puppet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../move_customer_repo/" class="md-nav__link">
        Move Sitegroup Repo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../move_provisioning_pointer/" class="md-nav__link">
        Moving the Index Provisioning Pointer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../multi_region_failover_testing/" class="md-nav__link">
        Performing a Multi-Region Failover Test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../multi_tier_to_full_tier/" class="md-nav__link">
        Multi-tier to Full-tier Upsize
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../multi_tier_to_single_tier/" class="md-nav__link">
        Multi-tier to Single-tier Downsize
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-daily-replication-fix/" class="md-nav__link">
        MySQL Daily Replication Fix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql_audit/" class="md-nav__link">
        Enabling or Disabling MySQL Auditing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql_upgrade_5733/" class="md-nav__link">
        MySQL / Percona Server 5.7.33 Upgrade
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../orphans/" class="md-nav__link">
        Orphans
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        SSL Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../point_in_time_recovery/" class="md-nav__link">
        MySQL Point in Time Recovery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../preallocating_eips_for_webs/" class="md-nav__link">
        Preallocating EIPs for webs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_ace/" class="md-nav__link">
        Gather Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_ace_customer/" class="md-nav__link">
        Provision customer hardware and sites
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_ace_dedicated_cron/" class="md-nav__link">
        Dedicated Cron
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_ace_empfree/" class="md-nav__link">
        Provisioning employee free sites
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_ace_infra/" class="md-nav__link">
        Provision shared and infra hardware
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_acp/" class="md-nav__link">
        Manually Provision a DevCloud Site & Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_acsf/" class="md-nav__link">
        Site Factory provisioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_bastion/" class="md-nav__link">
        Provisioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_log_server/" class="md-nav__link">
        Log Servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_multi_region/" class="md-nav__link">
        Multi-Region Provisioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_search_colony/" class="md-nav__link">
        Provisioning a Search Colony
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_search_farm/" class="md-nav__link">
        Provision a Search Farm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provision_site/" class="md-nav__link">
        Site Provision
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provisioning_a_fedramp_site_with_acquia_shield/" class="md-nav__link">
        Provision FedRAMP Customer Site with Acquia Cloud Shield
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provisioning_a_fedramp_site_without_acquia_shield/" class="md-nav__link">
        Provision FedRAMP Customer Site without Acquia Cloud Shield
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../provisioning_mail_server/" class="md-nav__link">
        Provisioning a mail server for Acquia Hosting Platform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../puppet_master/" class="md-nav__link">
        Generating and updating the root CA cert for puppet master
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../regenerate_netrcs/" class="md-nav__link">
        Regenerating netrc Credentials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../releasing_domains/" class="md-nav__link">
        Site Domains Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../remove_user/" class="md-nav__link">
        Deprovision User Access
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../renewing_certificates/" class="md-nav__link">
        Renewing SSL Certificates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../renewing_puppet_master_cert/" class="md-nav__link">
        Renewing SSL cert for puppet master
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../resize_volumes_bastion/" class="md-nav__link">
        Modify volumes on bastions manually
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../restore_snapshot_on_new_hardware/" class="md-nav__link">
        Restore Snapshots on New Hardware (ACE)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../restore_volumes/" class="md-nav__link">
        Restore Volume Backups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../revert_ssl/" class="md-nav__link">
        Restoring an Acquia-Managed SSL Cert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../root_cause_analysis/" class="md-nav__link">
        Root Cause Analysis Process
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../search_audit/" class="md-nav__link">
        Shared Search Audit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../search_cert_update/" class="md-nav__link">
        Renewal ACM Certificates In Search Realm ELBs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../search_index_migration/" class="md-nav__link">
        Search Index Migration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../secondary_db_cluster/" class="md-nav__link">
        Provisioning of single-region secondary database cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../self_service_ssl/" class="md-nav__link">
        Self-service SSL (on ELBs)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../single_tier_to_multi_tier/" class="md-nav__link">
        Single-tier to Multi-tier Upsize
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../single_tier_to_multi_tier_manual/" class="md-nav__link">
        Single-tier to Multi-tier Upsize
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../site_audit/" class="md-nav__link">
        Performing a Site Audit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../site_move/" class="md-nav__link">
        Site Move
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sni_ssl/" class="md-nav__link">
        SNI Certificates (deployed to bals)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ssl_acm/" class="md-nav__link">
        AWS Certificate Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../staging_single_tier_to_multi_tier_manual/" class="md-nav__link">
        Staging Single Tier to Multi-tier Upsize
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../svn_server_certificates/" class="md-nav__link">
        SVN Server Certificates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../toc/" class="md-nav__link">
        Kanban Tickets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting_bastion/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting_yubikey/" class="md-nav__link">
        Troubleshooting Yubikey
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../unblocking_email_service/" class="md-nav__link">
        Unblock Email Sending for a Customer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../unique_multisite_hash_salt/" class="md-nav__link">
        Enabling Unique Multisite Hash Salt on a Site
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../update_colony_certificate/" class="md-nav__link">
        Update Search Colony Certificate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../varnish_gather/" class="md-nav__link">
        VarnishGather
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../verify_extractor/" class="md-nav__link">
        Search Extractor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vpc_deprovision/" class="md-nav__link">
        Deprovision a VPC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vpc_network_boundaries/" class="md-nav__link">
        VPC Network Boundaries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vpc_provision/" class="md-nav__link">
        Provision a VPC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vpc_to_vpc/" class="md-nav__link">
        VPC to VPC  Migration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vpc_vpn_deprovision/" class="md-nav__link">
        Deprovision a Shield VPN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vpc_vpn_management/" class="md-nav__link">
        Updating Shield VPNs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vpc_vpn_provision/" class="md-nav__link">
        Provisioning a Shield VPN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wildcard_certificates/" class="md-nav__link">
        Wildcard Certificates
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_119" type="checkbox" id="__nav_5_119" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_119">
          Dedicated bals
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Dedicated bals" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_119">
          <span class="md-nav__icon md-icon"></span>
          Dedicated bals
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dedicated_bals/dedicated_to_dedicated/" class="md-nav__link">
        Dedicated To Dedicated
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dedicated_bals/dedicated_to_shared/" class="md-nav__link">
        Dedicated to Shared
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dedicated_bals/shared_to_dedicated/" class="md-nav__link">
        Shared to Dedicated
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dedicated_bals/shared_to_shared/" class="md-nav__link">
        Shared to Shared
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_120" type="checkbox" id="__nav_5_120" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_120">
          Test vcl
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Test vcl" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_120">
          <span class="md-nav__icon md-icon"></span>
          Test vcl
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../test_vcl/automated/" class="md-nav__link">
        Test VCL Deployment - Automated
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../test_vcl/manual/" class="md-nav__link">
        Test VCL Deployment - MANUAL
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Ops infrastructure
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Ops infrastructure" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Ops infrastructure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_infrastructure/" class="md-nav__link">
        Ops Infrastructure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_infrastructure/alerts/" class="md-nav__link">
        alerts.ops.acquia.com
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_infrastructure/compiling_ah_check_http/" class="md-nav__link">
        Compiling nagios plugin check_http for mon2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_infrastructure/gordon_deploy/" class="md-nav__link">
        OPS-Gordon Deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_infrastructure/gordon_prod_issues/" class="md-nav__link">
        OPS-Gordon Production Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_infrastructure/oneoffs/" class="md-nav__link">
        General Information About One-Off Servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_infrastructure/perfmon/" class="md-nav__link">
        perf-mon.ops.acquia.com
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Ops reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Ops reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Ops reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_reference/" class="md-nav__link">
        Ops Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_reference/deploy_secrets_masterless/" class="md-nav__link">
        Deploying secrets with Masterless Puppet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_reference/scp/" class="md-nav__link">
        SCP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_reference/services_overview/" class="md-nav__link">
        Overview of Common Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_reference/ssh_between_servers/" class="md-nav__link">
        SSHing Between Servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_reference/ssh_search_jumpbox/" class="md-nav__link">
        Search Jumpboxes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ops_reference/strace/" class="md-nav__link">
        Using `strace`
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Realm management
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Realm management" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Realm management
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/" class="md-nav__link">
        Realm Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/audit_data_backup/" class="md-nav__link">
        Audit Data Backup Log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/audit_iptables_sgroups/" class="md-nav__link">
        Audit IPtables Security Groups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/audit_services_protocols_ports/" class="md-nav__link">
        Audit Services Protocols Ports
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/audit_sudoers/" class="md-nav__link">
        Audit Sudoers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/audit_user_access/" class="md-nav__link">
        User Access Audit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/mntfs-volume-reaping/" class="md-nav__link">
        Reaping of Unused `/mnt` EBS Volumes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/mysql_restarts/" class="md-nav__link">
        MySQL Restart Mass Process
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/patching/" class="md-nav__link">
        Mass patching
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/provision_new_region/" class="md-nav__link">
        Provision New Region
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/qna_on_reboot_relaunches/" class="md-nav__link">
        Frequently Asked Questions on Reboots and Relaunches
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/reboot_balancers/" class="md-nav__link">
        Reboot Bals Using Workflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/reboot_master/" class="md-nav__link">
        Reboot a Master
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/reboot_search/" class="md-nav__link">
        Mass Rebooting Search Servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/rebooting_aws/" class="md-nav__link">
        Mass patching using AWS method
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/rebooting_relaunching/" class="md-nav__link">
        Mass Rebooting and Relaunching Procedure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/relaunch/" class="md-nav__link">
        Relaunch Instances
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/relaunch_backup/" class="md-nav__link">
        Backup Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/relaunch_balancers/" class="md-nav__link">
        Relaunch Bals Using Workflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/relaunch_master/" class="md-nav__link">
        Relaunch a Master
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/relaunch_master_manual/" class="md-nav__link">
        Relaunch a Master (manual process)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/relaunch_search/" class="md-nav__link">
        Mass Relaunching Search Servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/site_config_changes/" class="md-nav__link">
        Bulk config settings changes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/volume_relaunch_fix/" class="md-nav__link">
        Volume Relaunch Fix
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_25" type="checkbox" id="__nav_8_25" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_25">
          Procedures
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Procedures" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_25">
          <span class="md-nav__icon md-icon"></span>
          Procedures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/backup/" class="md-nav__link">
        Reboot Backup Servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/balancer/" class="md-nav__link">
        Balancer Mass Reboots / Relaunches
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/cplane/" class="md-nav__link">
        Control Plane
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/custom_servers/" class="md-nav__link">
        Custom servers (`custom`)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/databases/" class="md-nav__link">
        Database Mass Reboot/Relaunch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/fs/" class="md-nav__link">
        Filesystem Server Mass Reboot/Relaunch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/manual_databases/" class="md-nav__link">
        Databases (dbmaster, ded, fsdb)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/manual_fs/" class="md-nav__link">
        Filesystem Server Mass Reboot/Relaunch - Manual
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/manual_webs/" class="md-nav__link">
        Manual Reboot or Relaunch Webs(`api`, `web`)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/non_ha/" class="md-nav__link">
        Customer Non-HA Servers (`free`, `srv`, `staging`, `api`)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/reboot_node_servers/" class="md-nav__link">
        Rebooting node/nodebal servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/relaunch_node_servers/" class="md-nav__link">
        Relaunching node/nodebal servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/task/" class="md-nav__link">
        Task Servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/tungsten/" class="md-nav__link">
        Multiregion Database Mass Reboot/Relaunch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/webs/" class="md-nav__link">
        Webs (`web`)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../realm_management/procedures/workflow_errors/" class="md-nav__link">
        Dealing with Workflow errors
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Runbook metadocs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Runbook metadocs" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Runbook metadocs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../runbook_metadocs/" class="md-nav__link">
        Runbook Metadocs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../runbook_metadocs/contribution/" class="md-nav__link">
        Welcome to Contributing to Ops Runbooks for Fields
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../runbook_metadocs/style/" class="md-nav__link">
        Ops Runbook (Fields) Style Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Secondary response
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Secondary response" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Secondary response
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/" class="md-nav__link">
        Secondary Response
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/cpu_wait/" class="md-nav__link">
        Diagnosing CPU Wait problems
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/db_error_lock_wait_timeout/" class="md-nav__link">
        MySQL lock_wait_timeout errors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/disable_acp_sales/" class="md-nav__link">
        Disable DevCloud Purchases
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/dump_restore_all/" class="md-nav__link">
        Dump Restore All Tungsten Hosts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/dump_restore_single/" class="md-nav__link">
        Dump Restore A Single Tungsten Slave
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/dump_restore_workflow/" class="md-nav__link">
        MySQL Dump Restore Workflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/fencing/" class="md-nav__link">
        Fencing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/fix-1970-timestamps/" class="md-nav__link">
        Fix 1970 timestamps for files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/mysql_service_issue_during_volume_resize/" class="md-nav__link">
        Fix MySQL service issue occured during volume resize
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/mysql_startup_failures/" class="md-nav__link">
        MySQL Startup Failure Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/pt-kill/" class="md-nav__link">
        pt-kill
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/reduce_sf_mysql_disk_usage/" class="md-nav__link">
        Reduce Site Factory MySQL Disk Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/replacing-brick-volumes/" class="md-nav__link">
        Replacing Brick Volumes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/replacing-bricks/" class="md-nav__link">
        Replacing Gluster Bricks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/search_disk_partitions/" class="md-nav__link">
        Search Disk Partitions Alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/split-brain/" class="md-nav__link">
        Split-brain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/tungsten_administration/" class="md-nav__link">
        General Administration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../secondary_response/xtrabackup/" class="md-nav__link">
        Xtrabackup Dump Restore
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          Standard maintenance
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Standard maintenance" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Standard maintenance
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/" class="md-nav__link">
        Standard Maintenance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/audit_shared_bal_pairs/" class="md-nav__link">
        Audit Shared Bal Pairs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/az_migration/" class="md-nav__link">
        AZ Migration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/az_migration_manual/" class="md-nav__link">
        Manual AZ Migration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/az_migration_manual_volume_m/" class="md-nav__link">
        AZ Migration (xvdm)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/az_migration_manual_volume_mn/" class="md-nav__link">
        AZ Migration (xvdm xvdn)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/az_migration_manual_volume_mno/" class="md-nav__link">
        AZ Migration (xvdm xvdn xvdo)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/az_migration_manual_volume_no/" class="md-nav__link">
        AZ Migration (xvdn xvdo)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/fedramp_relaunch/" class="md-nav__link">
        Relaunching into FedRAMP compliance VPC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/fips-140-2/" class="md-nav__link">
        FIPS 140-2 compliant instance management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/moving_a_fedramp_site_with_acquia_shield/" class="md-nav__link">
        Moving a FedRAMP Site with Acquia Cloud Shield
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/moving_a_fedramp_site_without_acquia_shield/" class="md-nav__link">
        Moving a FedRAMP Site without Acquia Cloud Shield
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/relaunch_bastion/" class="md-nav__link">
        Relaunching
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/replace_volumes/" class="md-nav__link">
        Replacing a Bad Volume Manually
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/resize_volumes/" class="md-nav__link">
        Resize volumes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/resize_volumes_manual/" class="md-nav__link">
        Resize volumes manually
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11_17" type="checkbox" id="__nav_11_17" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11_17">
          Fips 140 2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Fips 140 2" data-md-level="2">
        <label class="md-nav__title" for="__nav_11_17">
          <span class="md-nav__icon md-icon"></span>
          Fips 140 2
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/fips-140-2/fips_check/" class="md-nav__link">
        Check whether a server is already FIPS compliant
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/fips-140-2/fips_disable/" class="md-nav__link">
        Disable FIPS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/fips-140-2/fips_enable/" class="md-nav__link">
        Enable FIPS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/fips-140-2/fips_migrate_db/" class="md-nav__link">
        Enable FIPS on DB servers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/fips-140-2/fips_mysql_upgrade/" class="md-nav__link">
        Upgrading mysql tier to be FIPS 140-2 compliant
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../standard_maintenance/fips-140-2/fips_provision/" class="md-nav__link">
        FIPS 140-2 compliant server provisioning
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#this-process-should-be-used-only-on-gluster-30-servers" class="md-nav__link">
    THIS PROCESS SHOULD BE USED ONLY ON GLUSTER 3.0 SERVERS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initial-variables" class="md-nav__link">
    Initial Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#info-gathering" class="md-nav__link">
    Info Gathering
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#provision-new-fs-servers-and-fix-volumes" class="md-nav__link">
    Provision new FS servers and fix volumes
  </a>
  
    <nav class="md-nav" aria-label="Provision new FS servers and fix volumes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#allocate-new-fs-servers" class="md-nav__link">
    Allocate new FS servers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-brick-volumes" class="md-nav__link">
    Add brick volumes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-fs-servers-for-gluster-34" class="md-nav__link">
    Configure FS servers for gluster 3.4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocate-fs-cluster" class="md-nav__link">
    Allocate FS cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fix-backup-vol-on-secondary-server-to-1gb" class="md-nav__link">
    Fix backup vol on secondary server to 1gb
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fix-ebs1-volumes-on-both-servers-to-1gb" class="md-nav__link">
    Fix ebs1 volumes on both servers to 1gb
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#launch-fs-servers" class="md-nav__link">
    Launch FS Servers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filesystem-data-transfer" class="md-nav__link">
    Filesystem Data Transfer
  </a>
  
    <nav class="md-nav" aria-label="Filesystem Data Transfer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-temporary-ssh-key" class="md-nav__link">
    Create Temporary SSH key
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsync-from-source-server-to-destination-server" class="md-nav__link">
    rsync from source server to destination server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-servers-cutover" class="md-nav__link">
    Web servers cutover
  </a>
  
    <nav class="md-nav" aria-label="Web servers cutover">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#take-webs-out-of-rotation" class="md-nav__link">
    Take webs out of rotation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#re-run-rysnc" class="md-nav__link">
    Re-run rysnc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-puppet-and-cron-on-webs" class="md-nav__link">
    Disable Puppet and cron on webs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stop-gluster-and-unmount-gluster" class="md-nav__link">
    Stop gluster and Unmount gluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-webs-to-new-fs-cluster" class="md-nav__link">
    Add webs to New FS cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relaunch-suspended-webs" class="md-nav__link">
    Relaunch suspended webs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remount-gluster-on-webs" class="md-nav__link">
    Remount gluster on webs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-gluster-for-site" class="md-nav__link">
    check gluster for site
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-webs-back-into-rotation" class="md-nav__link">
    Put webs back into rotation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart-php-run-fcw-on-webs" class="md-nav__link">
    Restart PHP, Run FCW on webs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification" class="md-nav__link">
    Verification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup" class="md-nav__link">
    Cleanup
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/acquia/ops-runbook-fields.git/edit/master/docs/kanban_tickets/gluster-upgrade.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="upgrade-gluster-version-from-30-to-34">Upgrade Gluster Version from 3.0 to 3.4</h1>
<h2 id="this-process-should-be-used-only-on-gluster-30-servers">THIS PROCESS SHOULD BE USED ONLY ON GLUSTER 3.0 SERVERS</h2>
<p>It may be necessary to upgrade a filesystem stack running 3.0 to 3.4 if recommended by
Cloud Data Team. <strong>This process will involve an approximate downtime of 30 minutes.</strong></p>
<h2 id="initial-variables">Initial Variables</h2>
<pre><code>JIRA_TICKET=
USER=
</code></pre>
<h2 id="info-gathering">Info Gathering</h2>
<p>FS Servers mentioned above refers to the filesystem servers in the stack. If you have
sitename, you can query for fs servers using below command to find the filesystem
servers in the stack</p>
<pre><code>SITE=

esl2 ${SITE}
</code></pre>
<p>From the tool output, Pick the filesystem servers in the stack serving the above site and
assign the below values:</p>
<pre><code>OLD_FS1=
OLD_FS2=
</code></pre>
<p>Gather volume information attached to the filesystem servers using the command</p>
<pre><code>sv-vollist ${OLD_FS1}
sv-vollist ${OLD_FS2}

FS_SIZE=
EBS_TYPE=
</code></pre>
<p>Volume size and ebs volume type should be read from the output of the volume info
command unless customer is approved for an upsize. The values should be referred
corresponding to <code>/dev/xvdo</code> device.</p>
<h2 id="provision-new-fs-servers-and-fix-volumes">Provision new FS servers and fix volumes</h2>
<p>It would be ideal to move the filesystem data from like-for-like servers. For example,
if the site is currently served by fsdb/ded, it is suggested to move them to fsdb/ded.
Similarly site served by fs server type should be moved to fs type. All other variables
required for new filesystem server launches should depend on the customer's existing
hardware.</p>
<pre><code>esl2 ${SITE}
</code></pre>
<p>From the above command output we need to pick the <code>VPC_ID</code> for the associated webs to
bring up filesystem servers also in the same vpc.</p>
<pre><code>SERVER_TYPE=
INSTANCE_TYPE=
AZ1=
AZ2=
REGION=
VPC_ID=
</code></pre>
<h3 id="allocate-new-fs-servers">Allocate new FS servers</h3>
<pre><code>FS1=$(ah-server allocate ${SERVER_TYPE} \
    --ami-type ${INSTANCE_TYPE} \
    --region ${REGION} \
    --avail-zone ${AZ1} \
    --vpc-id ${VPC_ID} \
    --secondary-volume-size ${FS_SIZE} --pe --se)

FS2=$(ah-server allocate ${SERVER_TYPE} \
    --ami-type ${INSTANCE_TYPE} \
    --region ${REGION} \
    --avail-zone ${AZ2} \
    --vpc-id ${VPC_ID} \
    --secondary-volume-size ${FS_SIZE} --pe --se)
</code></pre>
<p>Successful execution of the commands should return server names for <code>echo $FS1 $FS2</code>.</p>
<h3 id="add-brick-volumes">Add brick volumes</h3>
<pre><code>ah-volume add-brick --server ${FS1} --device /dev/xvdo --size ${FS_SIZE} \
          --ebs-volume-type ${EBS_TYPE} --set-encrypted

ah-volume add-brick --server ${FS2} --device /dev/xvdo --size ${FS_SIZE} \
          --ebs-volume-type ${EBS_TYPE} --set-encrypted
</code></pre>
<p>Successful execution of the commands should return Brick IDs.</p>
<h3 id="configure-fs-servers-for-gluster-34">Configure FS servers for gluster 3.4</h3>
<pre><code>GLUSTER_VERSION=3.4
ah-server edit ${FS1},${FS2} -c puppet:gluster_version=${GLUSTER_VERSION}
</code></pre>
<p>Successful execution of the command should set <code>puppet:gluster_version</code> config with the
<code>GLUSTER_VERSION</code> value.</p>
<h3 id="allocate-fs-cluster">Allocate FS cluster</h3>
<pre><code>./fields-provision.php --fs-cluster-allocate ${SITE}_$(date +%s):${FS1},${FS2}
</code></pre>
<p>Successful execution of the command should return FS cluster name.</p>
<h3 id="fix-backup-vol-on-secondary-server-to-1gb">Fix backup vol on secondary server to 1gb</h3>
<p>Of the two servers launched, highest numbered server will be called as secondary server.
Backups are run and saved only on primary server on our platform. For that reason, backup
volume on secondary server goes unused. We can save AWS cost by resizing the backup
volume on secondary server to 1gb.</p>
<pre><code>sv-vollist ${FS2}
</code></pre>
<p>Pick the volume ID corresponding to the <code>/vol/backup-ebs/(/dev/xvdn)</code> device to proceed
with resize.</p>
<pre><code>FS2_BACKUP_VOL_ID=
ah-volume edit ${FS2_BACKUP_VOL_ID} -s size=1
</code></pre>
<p>Successful execution of the command should change the volume size.</p>
<h3 id="fix-ebs1-volumes-on-both-servers-to-1gb">Fix ebs1 volumes on both servers to 1gb</h3>
<p>This step is only applicable if ${FS1} and ${FS2} are <code>fs</code> server type. This resize is
also to save AWS cost for the unused volume resource.</p>
<pre><code>sv-vollist ${FS1}
sv-vollist ${FS2}

FS1_EBS_VOL_ID=
FS2_EBS_VOL_ID=
ah-volume edit ${FS1_EBS_VOL_ID} -s size=1
ah-volume edit ${FS2_EBS_VOL_ID} -s size=1
</code></pre>
<h3 id="launch-fs-servers">Launch FS Servers</h3>
<pre><code>sv-taskrelaunch server -m1 ${FS1} ${FS2}
</code></pre>
<p>Successful execution of the command should trigger a task for each of the servers to be
launched and return the tasks state as done with successful server launches.</p>
<h2 id="filesystem-data-transfer">Filesystem Data Transfer</h2>
<h3 id="create-temporary-ssh-key">Create Temporary SSH key</h3>
<p>We need to create a ssh keypair on ${OLD_FS1} and copy the public key to authorized keys
on ${FS1}. This will enable us to establish a rsync connection for data transfer.</p>
<pre><code>fssh ${OLD_FS1} "sudo ssh-keygen -b 2048 -f /root/.ssh/${JIRA_TICKET}; \
    sudo cat /root/.ssh/${JIRA_TICKET}.pub"
</code></pre>
<p>You need to manual specify the value of ${JIRA_TICKET} as we are inside the server.
The above command execution will prompt for passphrase which is optional. You can specify
a passphrase or press enter key to skip. Surgically insert the public key, CAREFULLY, in
to the authorized keys file on the ${FS1} server.</p>
<pre><code>fssh ${FS1}
sudo su -
vim /root/.ssh/authorized_keys2
</code></pre>
<p>Paste in the contents of the pub key inclusive of "ssh-rsa" and the server hostname
including the server hostname makes it obvious to other Ops people that the key was
a temporary one.</p>
<h3 id="rsync-from-source-server-to-destination-server">rsync from source server to destination server</h3>
<p>This step involves rsyncing the data from ${OLD_FS1} to ${FS1}.</p>
<pre><code>FS1_FQHN=$(fqual ${FS1})
fssh ${OLD_FS1}
sudo su -
JIRA_TICKET=
screen -mS ${JIRA_TICKET}
FS1_FQHN=
JIRA_TICKET=
rsync -avPe "ssh -i /root/.ssh/${JIRA_TICKET}" --exclude=.glusterfs \
        /mnt/brick*/ ${FS1_FQHN}:/mnt/gfs/
</code></pre>
<p>Successful execution of the rsync command will start the data transfer and the time for
completion will depend on the amount of data we are trying to transfer. In another
terminal window, we can watch the progress of data transfer on ${FS1}</p>
<pre><code>fssh ${FS1}
sudo su -
watch 'df -h /mnt/gfs'
</code></pre>
<p>Once the transfer has completed, run a second rsync to ensure that any new data created
on the brick gets transferred to ${FS1} server.</p>
<pre><code>fssh ${OLD_FS1}
sudo su -
JIRA_TICKET=
screen -mS ${JIRA_TICKET}
FS1_FQHN=
JIRA_TICKET=
rsync -avPe --delete "ssh -i /root/.ssh/${JIRA_TICKET}" --exclude=.glusterfs \
        /mnt/brick*/ ${FS1_FQHN}:/mnt/gfs/
</code></pre>
<h2 id="web-servers-cutover">Web servers cutover</h2>
<p>This process involves pointing the web servers serving the site to point to newly created
filesystem servers.<strong>This process involves downtime as we will take webs out of rotation.
After this point the site will be down. Ping ops hotseat person about the site downtime
alert. At any point if ops were to abort the cutover process, ops person should undo all
the steps that were done until that point.</strong></p>
<h3 id="take-webs-out-of-rotation">Take webs out of rotation</h3>
<pre><code>WEBS=$(ah-server list site:${SITE} -w type=web status=0 | paste -sd,)
sv-mondisable ${WEBS}
sv-webdisable ${WEBS}
</code></pre>
<p>Successful execution of the command will set <code>web_service_status</code> to 1 for all the web
servers serving the site.</p>
<h3 id="re-run-rysnc">Re-run rysnc</h3>
<p>Once the webs are out of rotation, we should run another run of rsync to ensure there is
no mis-match of data between ${OLD_FS1} and ${FS1} servers.</p>
<pre><code>fssh ${OLD_FS1}
sudo su -
JIRA_TICKET=
screen -mS ${JIRA_TICKET}
JIRA_TICKET=
FS1_FQHN=
rsync -avPe --delete "ssh -i /root/.ssh/${JIRA_TICKET}" --exclude=.glusterfs \
        /mnt/brick*/ ${FS1_FQHN}:/mnt/gfs/
</code></pre>
<h3 id="disable-puppet-and-cron-on-webs">Disable Puppet and cron on webs</h3>
<pre><code>fpdsh -l ${WEBS} -c "sudo puppet agent --disable ${JIRA_TICKET} &amp;&amp; \
    sudo service cron stop"
</code></pre>
<h3 id="stop-gluster-and-unmount-gluster">Stop gluster and Unmount gluster</h3>
<pre><code>fpdsh -l ${WEBS} -c 'sudo service glusterfs-server stop'
fpdsh -l ${WEBS} -c 'sudo umount /mnt/gfs'
</code></pre>
<h3 id="add-webs-to-new-fs-cluster">Add webs to New FS cluster</h3>
<pre><code>NEW_FS_CLUSTER_ID=$(ah-server list ${FS1} -c fs_cluster_id --no-name)
</code></pre>
<p>To add webs to fs cluster, we have to do four steps. First we have to suspend the webs,
unset the existing <code>fs_cluster_id</code>, update the gluster_version to ${GLUSTER_VERSION} and
finally set ${NEW_FS_CLUSTER_ID} to webs.</p>
<pre><code>ah-server suspend $WEBS -P
ah-server edit $WEBS --unset fs_cluster_id
ah-server edit $WEBS -c puppet:gluster_version=$GLUSTER_VERSION
ah-server edit $WEBS -s fs_cluster_id=$NEW_FS_CLUSTER_ID
</code></pre>
<h3 id="relaunch-suspended-webs">Relaunch suspended webs</h3>
<pre><code>sv-taskrelaunch server $WEBS -m 1
</code></pre>
<p>Successful execution of the command will relaunch webs and turn on the monitoring.
Unfortunately, the tool doesn't exit cleanly in the current state. You might have to open
a new session, hop onto the stage and verify the state of tasks. The tasks should be
successful in ~10 minutes. Once the tasks are successful, you can interrupt the relaunch
command execution. You can ensure webs are in good state by running <code>check_services</code> as
a root user on the server.</p>
<h3 id="remount-gluster-on-webs">Remount gluster on webs</h3>
<pre><code>site-fsremount ${SITE}
</code></pre>
<h3 id="check-gluster-for-site">check gluster for site</h3>
<pre><code>site-checkgluster ${SITE}
</code></pre>
<h3 id="put-webs-back-into-rotation">Put webs back into rotation</h3>
<pre><code>sv-webenable ${WEBS}
sv-monenable $WEBS
</code></pre>
<h3 id="restart-php-run-fcw-on-webs">Restart PHP, Run FCW on webs</h3>
<pre><code>fpdsh -t $WEBS -c "sudo service safe-httpd restart"
site-restartfpm ${SITE}
site-fcw ${SITE}
</code></pre>
<h2 id="verification">Verification</h2>
<pre><code>site-check ${SITE}
site-checkwebs ${SITE}
</code></pre>
<p>If ${SITE} is an ACSF site, you can verify if sites.json file is present in the correct
path by ssh'ing to a web server and running the below command:</p>
<pre><code>[ -f /mnt/files/${SITE}/files-private/sites.json ] &amp;&amp; echo "Found" || \
    echo "Not found"
</code></pre>
<p>Compare the number of files on the source filesystem server and destination filesystem
server. We can check this by doing:</p>
<pre><code>fssh ${OLD_FS1} 'sudo find /mnt/gfs/ -type f | wc -l'
fssh ${FS1} 'sudo find /mnt/gfs/ -type f | wc -l'
</code></pre>
<p>You can also do additional checks for an acsf site by doing a curl on one of the domains
for the ${SITE}. This check is optional.</p>
<pre><code>DOMAINS=$(ah-site get ${SITE} | grep 'domains\.' | awk -F: '{print $2}')
for D in ${DOMAINS}; do curl -IL ${D}; done
</code></pre>
<p>The curl request will return 200 if everything is OK with the ${SITE}.</p>
<h2 id="cleanup">Cleanup</h2>
<p>Once the site is operational, we would normally deprovision old servers. You have to be
careful doing this step because if the ${SERVER_TYPE} is fsdb/ded then you should not
terminate the servers and attached volumes unless the ${SITE} databases are moved to new
set of servers. Otherwise, you can deprovision the hardware using the runbook available
<a href="https://runbook.ops.acquia.com/master/instance_deprovision/ace/#deprovisioning">here</a>.</p>
<p>We should also remove the temporary ssh key on ${FS1} server as we no longer need that.
This can be done using below steps:</p>
<pre><code>fssh ${FS1}
sudo su-
vim ~/.ssh/authorized_keys2
</code></pre>
<p>The temporary key will have a suffix of the ${OLD_FS1} server hostname at the end. The
key should be deleted carefully without disturbing any existing entries in the file.
Once deleted, save the file and exit.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../gluster-downgrade/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Downgrade Gluster Version from 3.4 to 3.0" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Downgrade Gluster Version from 3.4 to 3.0
            </div>
          </div>
        </a>
      
      
        
        <a href="../loadtest_balancer/" class="md-footer__link md-footer__link--next" aria-label="Next: Load Test Balancer" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Load Test Balancer
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.0bbba5b5.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.e1a181d9.min.js"></script>
      
    
  </body>
</html>